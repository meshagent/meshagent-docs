---
title: REST API
---
import GetDynamicToken from "/snippets/examples/python/rest_api/get_token_dynamically.mdx"
import GetCLIToken from "/snippets/examples/python/rest_api/get_token_from_cli_session.mdx"

The MeshAgent REST API is the **control plane** for MeshAgent. It exposes administrative and lifecycle operations for projects, rooms, users, permissions, services, storage, billing, sessions, and integrations.

Use this API to manage your account/projects and provision resources, manage access, configure services, inspect activity, and integrate MeshAgent into external systems. For room-specific operations such as working with agents, databases, or storage use the [Room APIs](../room_api/overview).

## Getting started

To call the MeshAgent REST API you must authenticate using **OAuth**. The simplest path is:

1) **Create an OAuth client** in [MeshAgent Studio](https://studio.meshagent.com)  
2) **Log in with the CLI** (this stores a session token locally)  
3) **Use the stored access token** or fetch one dynamically in your application

### 1. Create an OAuth Client in [MeshAgent Studio](https://studio.meshagent.com)
1. In [MeshAgent Studio](https://studio.meshagent.com), open the **OAuth** tab  
2. Click **New OAuth Client**  
3. Name your client  
   - You do not need to configure scopes or redirect URIs for REST API usage  
4. Click **Create**  
5. Copy the generated credentials:
   - `OAUTH_CLIENT_ID`
   - `OAUTH_CLIENT_SECRET`

### 2. Authenticate with the CLI

Export your credentials and run setup:

```bash
export OAUTH_CLIENT_ID="xxx"
export OAUTH_CLIENT_SECRET="xxx"
meshagent setup
```

### 3. Create a MeshAgent client
You can authenticate in one of two ways:

**Option A**: Fetch an access token dynamically

<CodeGroup>
    <GetDynamicToken />
</CodeGroup>

**Option B**: Use the saved CLI session token

<CodeGroup>
    <GetCLIToken />
</CodeGroup>

### Client configuration
The `Meshagent()` client accepts a `base_url` and `token`.
- `base_url`: defaults to `MESHAGENT_API_URL` (defaults to https://api.meshagent.com)
- `token`: this should be a valid OAuth access token (from get_access_token() or CLI session). It defaults to `MESHAGENT_API_KEY`. API Keys are scoped to a specific project so cannot be used for global account based tasks like listing projects etc. API keys can be used for non user-specific operations like updating a service. 

Every method raises `meshagent.api.RoomException` on non-2xx responses and validates responses with Pydantic models, so malformed payloads surface as rich errors.

## Managing project room grants
Project room grants store a user's allowed `ApiScope` for a specific room. They are persisted as `ProjectRoomGrant { room, user_id, permissions }` records and later copied into the runtime [`ParticipantToken`](./participant_tokens).

Key methods:

| Method | Description |
| ------ | ----------- |
| `create_room_grant(project_id, room_id, user_id, permissions)` | Creates a grant (POST `/accounts/projects/{project_id}/room-grants`). Accepts an `ApiScope` instance for `permissions`. |
| `update_room_grant(project_id, room_id, user_id, permissions)` | Replaces the stored `ApiScope` for an existing grant (PUT `/room-grants`). |
| `get_room_grant(project_id, room_id, user_id)` | Returns the persisted `ProjectRoomGrant` (GET `/room-grants/{room_id}/{user_id}`). |
| `list_room_grants(project_id, limit?, offset?, order_by?)` | Lists every grant in a project with pagination support. |
| `list_room_grants_by_user(project_id, user_id, ...)` | Lists the rooms a specific user can access. |
| `list_room_grants_by_room(project_id, room_id, ...)` | Lists the users that have access to a room. |
| `list_unique_rooms_with_grants(project_id, ...)` | Returns `ProjectRoomGrantCount` objects summarising how many grants exist per room. |
| `list_unique_users_with_grants(project_id, ...)` | Returns `ProjectUserGrantCount` objects summarising grant counts per user. |

Example: assign a user read-only storage access in a room.

```python
from meshagent.api.client import Meshagent
from meshagent.api.participant_token import ApiScope, StorageGrant, StoragePathGrant

scope = ApiScope(
    storage=StorageGrant(paths=[StoragePathGrant(path="/data", read_only=True)])
)

await client.create_room_grant(
    project_id="proj_123",
    room_id="room_456",
    user_id="user_789",
    permissions=scope,
)
```

When that user connects, the router copies `scope` into the `api` grant of the token it mints (`cloud_router_server.connect_room`).

## Other administration helpers
The client also exposes utilities for day-to-day project administration:

- **Room lifecycle**: create, rename, delete rooms; fetch room metadata.
- **Project membership**: add/remove users, check roles, and list members.
- **Storage helpers**: upload and download files under `/accounts/projects/{project_id}/storage/*`.
- **OAuth clients**: create, update, list, and delete OAuth client records for project integrations.

## Whatâ€™s next?
- Explore the [Room API overview](../room_api/overview) to work with live collaborative rooms.
- Review the [`ApiScope` reference](./api_scopes) for details on permission shape.
- Learn how room connections inherit grants in [participant tokens](./participant_tokens).