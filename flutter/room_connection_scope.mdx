---
title: Room Connection
description: Learn how to set up a room connection for your MeshAgent.
---

## Description

`RoomConnectionScope` is a widget that manages the connection lifecycle for a Meshagent `RoomClient`. Users provide an authorization callback that returns a `RoomConnectionInfo`, containing the connectionâ€™s URL and a JWT. Once authorization succeeds, a `RoomClient` is created and started. During authorization, you can optionally display a loading or progress indicator using the `authorizingBuilder`. After the connection is established, the main UI is built using the provided `builder` callback, which receives the active `RoomClient`. If the connection ends or encounters an error, the optional `doneBuilder` handles rendering the appropriate UI. The `RoomConnectionScope` ensures proper resource cleanup by automatically disposing of the `RoomClient` when the widget is removed from the widget tree.


## Example

```dart
import 'package:meshagent_flutter/meshagent_flutter.dart';

RoomConnectionScope(
  authorization: (context) async {
    // Perform your authorization logic here
    // For example, you might want to fetch a JWT token from your server
    final response = await fetchJwtToken();

    return RoomConnectionInfo(
      url: response['url'],
      jwt: response['jwt'],
    );
  },
  authorizingBuilder: (context) {
    return Center(child: CircularProgressIndicator());
  },
  builder: (context, client) {
    return Text('Connected to room: ${client.roomId}');
  },
  doneBuilder: (context, error) {
    return Text('Connection ended with error: $error');
  },
)
```
