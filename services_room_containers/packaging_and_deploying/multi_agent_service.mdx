---
title: "Deploy a Customizable Multi-Agent Service"
---

import NewsReporter from "/snippets/examples/packaging/news_reporter.mdx"

## Overview

This example deploys a daily news reporter service with three agents working together: a [ChatBot](../../agents/standard/chatbot) for interactive conversation, a [MailBot](../../agents/standard/mailbot) for sending and receiving email, and a [Worker](../../agents/standard/worker) that runs on a daily schedule to compose and send a news digest.

Because different users will want their own email address and recipient, this example uses a **ServiceTemplate** so users provide their values at deploy time. This example deploys a container-based service that uses the `meshagent-cli` base image.

Use this pattern when your service needs multiple agents coordinating in a room and users need to supply their own configuration.

## Prerequisites
- [MeshAgent CLI](../../cli/getting_started) installed and signed in (`meshagent setup`).
- A mailbox address for the mailbot (ask a project admin to create one if you can’t, or create one from the CLI or MeshAgent Studio. See example below).

## Step 1: Create the configuration file
This configuration defines a ServiceTemplate with three agents (ChatBot, MailBot, and Worker), two user-provided variables (the agent's email address and a recipient for the daily digest), and a container that runs all three agents together using meshagent multi join.

First, create a file called `meshagent.yaml` and copy the code:

<CodeGroup>
  <NewsReporter />
</CodeGroup>


Next, validate the template before deploying:

```bash 
meshagent service validate-template --file meshagent.yaml
```

### How it works

#### Three agents, one service

This service runs three agents under a single identity (`news-reporter`), each with a different role declared via the `meshagent.agent.type` annotation:

- **ChatBot** — An interactive agent in the room with access to web search, email tools, and storage. Users can chat with it to request a news briefing on demand.
- **MailBot** — Handles inbound and outbound email. The `meshagent.agent.schedule` annotation configures it to trigger the daily digest at 9:00 AM UTC.
- **Worker** — Processes queued tasks. When the schedule fires, the worker searches the web for news, saves a report to room storage, and sends the digest email.

All three are started together by `meshagent multi join`, which runs multiple agents in a single container. 

#### User-provided variables

Because this is a `ServiceTemplate`, two values are left for the user to fill in:

- `email` — The mailbot's email address. The `type: email` hint tells MeshAgent and Powerboards this should be a valid email address.
- `send_to_email` — Where the daily digest gets sent.

These appear as `{{email}}` and `{{send_to_email}}` in the `container.command` field. At deploy time, the `--value` flags (or Powerboards prompts) substitute the actual values in. See [`variables`](./packaging#variables-servicetemplate-only) in the field reference.

#### Container command

The `command` field runs `meshagent multi join`, which starts multiple agents in one container. The `-c` flag takes a semicolon-separated list of agent configurations. Each agent definition specifies its type, name, tools it needs access to (e.g., `--require-web-search`, `--require-toolkit=email`), its system prompt (`--rule`), and optionally room-editable rules files (`--room-rules`).

> **Room-editable rules**
> - Each agent references `--room-rules` files like `agents/news-reporter/chatbotrules.txt`. 
> - These are files in the room's storage that anyone in the room can edit to customize the agent's behavior after deployment — no redeployment needed. 
> - In this example you'll notice all three agents share the `news-reporter-rules.txt` file so you can apply global rules for the agents. The agents also each have their own individual `rules.txt` file for their unique rules. 

#### Participant token

The [`environment`](./packaging#containerenvironment) section injects a `MESHAGENT_TOKEN` with specific [API scopes](../../rest_api/api_scopes) granting the service permissions for messaging, storage, agent registration, queues, and more. The `api` object controls exactly what this service is allowed to do in the room.

#### Room storage

The [`storage.room`](./packaging#containerstorage) mount gives the container read/write access to the room's storage at `/data`. The worker uses this to save daily news reports as markdown files.

## Step 2: Create the mailbox
The MailBot agent needs a mailbox to send and receive email. Create one before deploying — update the address with your desired mailbox name: 

```bash 
meshagent mailbox create \
  --address news@mail.meshagent.com \ 
  --room myroom \
  --queue news@mail.meshagent.com  # match the queue to the email
```

> Add the `--public` flag if you want the mailbox to accept mail from anyone. By default it will only accept mail from room members.


## Step 3: Deploy the service
Deploy the template, providing the mailbox you just created and the email address you want to receive the daily digest:

```bash
meshagent service create-template \
  --file meshagent.yaml \
  --value email=news@mail.meshagent.com \
  --value send_to_email=you@example.com \
  --room myroom
```

## Step 4: Try it out
Open either [MeshAgent Studio](https://studio.meshagent.com) or [Powerboards](https://app.powerboards.com) and navigate to your room. Select the news-reporter agent and try requesting a briefing on demand — ask it to research a topic and send you an email. The scheduled daily digest will start sending automatically at the next 9:00 AM UTC.

## Step 5: Make it Shareable via Powerboards
Now that you've built and tested the service, you can turn it into a one-click install link so anyone can deploy it into their own room — no CLI required.

1. **Push your YAML to a GitHub Gist**: Go to [gist.github.com](https://gist.github.com/), and create a new gist containing your meshagent.yaml file.
2. **Get the raw URL**: On the gist page, click the Raw button to get the direct URL to the file. It will look something like:
    ```
    https://gist.githubusercontent.com/yourname/.../raw/.../meshagent.yaml
    ```
3. **Construct the install link**: Prefix the raw URL with `https://app.powerboards.com/install?url=:`. It will look like this:
    ```
    https://app.powerboards.com/install?url=https://gist.githubusercontent.com/yourname/.../raw/.../meshagent.yaml
    ```

When someone clicks this link, Powerboards will walk them through setup: they'll select a Project and Room, provide values for `email` and `send_to_email`, and Powerboards will create the mailbox and deploy the service automatically.

See [Sharing via Powerboards](../share_agents_in_powerboards) for more details. 

## Related Topics
- [Packaging services](./packaging)
- [Deploy from the CLI](./deploy_from_cli)
- [Sharing via Powerboards](../share_agents_in_powerboards)
- [Terminal-based agents](./terminal_based_agents)