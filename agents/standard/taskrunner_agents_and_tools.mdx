---
title: "Wrap an Existing Agent"
---

import PydanticAgents from "/snippets/examples/python/agents/taskrunner/pydantic_agents.mdx"
import InvokingTaskRunner from "/snippets/examples/python/agents/taskrunner/invoking_taskrunner.mdx"

## Example: Integrating a Pydantic AI Agent

This example shows how to wrap an existing Pydantic AI translation agent with a MeshAgent TaskRunner. We extend the base TaskRunner class to create our TranslationTaskRunner with a defined input schema, output schema, and ask method. 

### Building the Pydantic AI based TaskRunner
Copy this code into a file called ``translator.py``. You will need to create and export an ``ANTHROPIC_API_KEY`` first for this to run.

<CodeGroup>
    <PydanticAgents />
</CodeGroup>

### Running the TaskRunner

**In your terminal**

Start your service locally. Be sure you are in an activated virtual environment where meshagent and pydantic_ai are installed: 

```bash bash
python translator.py
```

Next use the MeshAgent CLI to authenticate and call your agent into a Room:
```bash bash
meshagent setup # this will authenticate you 
meshagent call agent --url=http://localhost:7777/translator --room=translate --participant-name=translator
```

**In the Studio**
1. Go to [studio.meshagent.com](https://studio.meshagent.com) 
2. Enter the room, ``translate``
3. Click menu --> "Run Task"
4. Select "translator" from the agent dropdown 
5. Enter the text to translate
6. Results appear and are saved to room storage under the "translations" folder 

**Invoking the TaskRunner Programmatically**

Instead of invoking the agent through the Studio, you can also run the agent through code like this. Let's create a file called ``invoke_translator.py``: 

<CodeGroup>
    <InvokingTaskRunner />
</CodeGroup>

From the terminal run:
```bash bash
meshagent env # you need to export the env variables first to invoke tools from code like this
python invoke_translator.py
```

You will see the result logged to your terminal and saved in the room. 


## Example: Using TaskRunner Agents as Agent Tools
TaskRunners can also be surfaced in toolkits and used as tools by other agents using ``RunTaskTool``. Exposing agents as tools and then giving those tools to a ChatBot is a great way to get started building multi-agent systems. 

Let's try this out by creating a new ChatBot and giving it a tool, the Pydantic AI translation agent that we defined above. 

### Creating the service with agents-as-tools
At the end of our ``translator.py`` file all we have to add is the new ChatBot service and pass it the ``translator`` agent as a ``RequiredToolkit``.

```python Python
@service.path("/chatwithtools")
class ChatBotAgentTools(ChatBot):
    def __init__(self):
        super().__init__(
            name="mychatbot",
            llm_adapter=OpenAIResponsesAdapter(),
            requires=[RequiredToolkit(name="agents", tools=["translator"])],
        )
```

### Running an agent with agents-as-tools

Run your python file with both the translator and the chatbot:

```bash bash
python translator.py
```

Call both agents into the room: 

```bash bash
meshagent setup #authenticate if not already connected
meshagent call agent --url=http://localhost:7777/translator --room=translate --participant-name=translator
meshagent call agent --url=http://localhost:7777/chatwithtools --room=translate --participant-name=chatagent
```

### Using the agent with agents as tools

**In the Studio**:
1. Go to [studio.meshagent.com](https://studio.meshagent.com)
2. Enter the room translate
3. In the participants list, you'll see the ``chatagent``
4. Click on ``chatagent`` to start chatting with the agent
5. Ask it something like: "Can you translate 'Hello, how are you?' for me?"
6. The ``chatagent`` will automatically use the ``translator`` agent as a tool to complete the request and you will see the JSON results added to the translations folder in the room storage. 

*Remember: You can still use the translator agent directly since it is running in the room, this approach just demonstrates an easy way to use agents as tools*