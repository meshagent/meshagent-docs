---
title: Configure Room Containers
---
Room containers let you run code on demand inside a specific room through the MeshAgent Containers API. Unlike project-wide services (which run across every room automatically), containers are launched ad hoc and can be customized at deployment time. This is particularly useful for scenarios where you want to allow others to deploy your container with their own configuration or run ad-hoc processes at any time inside a room.

You define a container with a ``ServiceTemplate`` (``kind: ServiceTemplate``) inside meshagent.yaml. At launch, MeshAgent combines user-supplied variable values with your template to generate a one-off ServiceSpec, which is what actually runs in the room.

Typical files youâ€™ll need:
- meshagent.yaml manifest (``ServiceTemplate``)
- A Dockerfile
- Your application code (e.g., ``main.py``)

## ServiceTemplate Reference
| Field       | Required? | Description                                                                     |
| ----------- | --------- | ------------------------------------------------------------------------------- |
| version     | Yes       | Template version (`v1`)                                                         |
| kind        | Yes       | Always `ServiceTemplate`                                                        |
| metadata    | Yes       | Name, description, optional repo and icon metadata                              |
| variables   | No        | Inputs collected at launch (can be required, optional, enumerated, or obscured) |
| environment | No        | Maps variables into environment variables                                       |
| ports       | Yes       | Ports/endpoints exposed by the container (MeshAgent will automatically assign services to available ports)                              |
| image       | No        | Default container image (can be overridden at launch)                           |
| command     | No        | Command that runs when your container starts (override the container entrypoint)                                            |
| role        | No        | Service role (`agent`, `tool`, or `user`) (optional, will likely be set at the port endpoints level)                           |
| storage     | No        | Room/project storage mounts                                                     |


### Metadata
Metadata keep track of important information about your service like the name and description, and optionally an icon associated with the service and repository where the code for the service lives. 

```yaml yaml
metadata: 
  name: agent-service
  description: "A chat based agent without tools"
```

### Variables
Variables let users provide values at launch. You can restrict inputs or hide sensitive ones. 

For example, if you need to pass a system prompt or api key you can setup the variables section like this.

```yaml yaml
variables:
- name: "system_prompt"
  description: "The system prompt for the chatbot"
- name: "tone"
  description: "Tone of the model"
  enum: ["formal", "casual", "enthusiastic"]
  optional: true
- name: "api_key"
  description: "External API key"
  obscure: true  # Hide value in UI
```

Variable Options:
- ``description``: Help text shown in the UI
- ``enum``: Dropdown list of allowed values
- ``optional``: Whether the variable is required
- ``obscure``: Hide the value in the UI (for sensitive data)

### Environment Variables
Map template variables to environment variables in the container using ``{variable_name}`` placeholders: 

```yaml yaml
environment:
- name: SYSTEM_PROMPT
  value: "{system_prompt}"
- name: TONE
  value: "{tone}"
- name: OPENAI_API_KEY
  value: "{api_key}"
```

### Ports and Endpoints
Define how MeshAgent connects to your service:

```yaml yaml
ports:
- num: "*"  # Let MeshAgent assign an available port
  liveness: "/"  # Health check endpoint to make sure tools and agents are ready 
  endpoints:
  - path: /agent
    identity: chatbot
    type: meshagent.callable
  - path: /tool
    identity: helper-tool
    type: meshagent.callable
```

Port Options:
- ``num``: Port number or "*" for auto-assignment
- ``liveness``: Health check path
- ``endpoints``: List of endpoints this port serves

Endpoint Options:
- ``path``: URL path for this endpoint
- ``identity``: Unique name for this agent/tool
- ``type``: Protocol type (meshagent.callable, mcp.sse, http, tcp)
- ``role``: Override the service role for this endpoint (optional)

### Storage
Optionally mount storage into your container for file access. This can be done at the room or project level. Room-storage is read/write by default. Project-wide storage is shared and read-only by default. For example: 

```yaml yaml
storage:
  room:
  - path: /data
    read_only: false
  - path: /app/shared
    subpath: "user-uploads"
    read_only: true
  project:
  - path: /app/models
    read_only: true
```

## Example

Let's create a simple chatbot that allows users to give it a system prompt when deploying. To deploy this we'll need the main.py file, a Dockerfile, and a meshagent.yaml file.

**main.py**

```python Python
import os
import asyncio
import logging
from meshagent.agents.chat import ChatBot
from meshagent.api.services import ServiceHost
from meshagent.openai import OpenAIResponsesAdapter

logging.basicConfig(level=logging.DEBUG)

system_prompt = os.getenv("SYSTEM_PROMPT")
rules = [system_prompt] if system_prompt else []

host = ServiceHost()

@host.path("/agent")
class MyChatBot(ChatBot): 
    def __init__(self):
        super().__init__(
            name="chatbot",
            rules=rules,
            llm_adapter=OpenAIResponsesAdapter(),
        )

asyncio.run(host.run())
```

**Dockerfile**

```Dockerfile Dockerfile
FROM meshagent/python-sdk-slim:latest

COPY . /src

WORKDIR /src

ENTRYPOINT [ "python3", "main.py" ]
```

**meshagent.yaml**
```yaml yaml
kind: ServiceTemplate
version: v1
metadata:
  name: chatbot
  description: "chatbot that takes a system prompt"

variables:
- name: "system_prompt"

environment:
- name: SYSTEM_PROMPT
  value: "{system_prompt}"
- name: tone
  enum: ["formal", "casual", "enthusiastic"]
  optional: true
ports:
- num: "*"
  liveness: "/"
  endpoints:
  - path: /agent
    identity: chatbot
    type: meshagent.callable
```

## Next Steps

Now that we have our agent code, Dockerfile, and meshagent.yaml file set up we're ready to build and push our container then run it inside a room. 

At launch, MeshAgent sets the user provided variables as environment variables and starts the container in the specified room. Continue with [Run room containers](./running) to learn how to run your container in a specific room. 
