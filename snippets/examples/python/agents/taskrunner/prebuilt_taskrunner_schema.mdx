```python Python
import os
import asyncio
import logging
from meshagent.api import RoomClient, WebSocketClientProtocol, ParticipantToken, ApiScope, ParticipantGrant
from meshagent.api.helpers import meshagent_base_url, websocket_room_url

logging.basicConfig(level=logging.INFO)
log = logging.getLogger(__name__)

def env(name: str) -> str:
    val = os.getenv(name)
    if not isinstance(val, str) or not val:
        raise RuntimeError(f"Missing required environment variable: {name}. Try running meshagent env in the terminal to export the required environment variables.")
    return val


async def run_schema_planner(room_name:str, prompt:str, output_schema:dict, participant_name:str="test_user"):
    """
    Run the Planner in a MeshAgent Room

    Args:
        room_name: Name of the room to connect to
        prompt: The user prompt to send to the agent
        output_schema: The structured output to use in the response 
        participant_name: Name to use as participant (defaults to "test_user")
    """
    try:
        async with RoomClient(
            protocol=WebSocketClientProtocol(
                url=websocket_room_url(room_name=room_name, base_url=meshagent_base_url()),
                token=ParticipantToken(
                    name="participant",
                    project_id=env("MESHAGENT_PROJECT_ID"),
                    api_key_id=env("MESHAGENT_KEY_ID"),
                    grants=[
                        ParticipantGrant(name="room", scope=room_name),
                        ParticipantGrant(name="role", scope="agent"),
                        ParticipantGrant(name="api", scope=ApiScope.agent_default()),
                    ],
                ).to_jwt(token=env("MESHAGENT_SECRET")),
            )
        ) as room:
            log.info(f"Connected to room: {room.room_name}")
            response = await room.agents.ask(
                agent="meshagent.schema_planner",
                arguments={
                    "prompt": prompt,
                    "output_schema": output_schema
                }
            )
            log.info(f"Response: {response}")
            return response
    except Exception as e:
        print(f"Connection failed: {e}")

        
# Try it with a sample schema
product_schema = {
    "type": "object",
    "additionalProperties": False,
    "properties": {
        "title": {"type": "string"},
        "price": {"type": "number"},
        "features": {"type": "array", "items": {"type": "string"}},
        "description": {"type": "string"}
    },
    "required": ["title", "price", "features", "description"]
}

asyncio.run(run_schema_planner(room_name="test", prompt="Create a product listing for a bluetooth speaker", output_schema=product_schema))
```

