---
title: Secrets & Registry Access
---

MeshAgent keeps credentials scoped to the service that owns them. Secrets never leak between services, and each service only has access to the entries you explicitly attach. There are two main categories:

- **Secret Keys**: Named key/value collections that MeshAgent injects as environment variables when the service starts.
- **Image Pull Secrets**: Credentials MeshAgent uses to pull private container images from your registry.

The guidance below covers project services first, followed by notes on supplying sensitive values to room containers.

## Secret Keys
### What they are
A secret key collection holds key/value pairs such as `API_KEY` or `DB_URI`. When attached to a project service, each key appears as an environment variable inside the container (`$API_KEY`, `process.env.DB_URI`, and so on).

### How they work
- After you attach a secret key collection to a service, MeshAgent injects each entry as an environment variable when the container starts.
- Only that service sees the variables; other services cannot access them unless you attach the same collection.
- You can rotate a value by creating a new collection (or updating the existing one) and redeploying the service.

### Configure in MeshAgent Studio
1. Open **Services & Room Containers → Secrets**.
2. Choose **New Secret Keys** and give the collection a descriptive name (for example, `weather-api`).
3. Add the key/value entries you need (`WEATHER_API_KEY`, `WEATHER_API_ENDPOINT`, …).
4. Save. MeshAgent stores the data encrypted and scoped to your project.

### Reference in a Service manifest
List the secret names in the ``secrets`` field of your ``kind: Service`` manifest (or pass them with the CLI `--env-secret` flag). MeshAgent expands each key at runtime.

```yaml yaml
kind: Service
version: v1
name: weather-agent
image: gcr.io/example/weather:latest
secrets:
  - weather-api
```

### Manage with the CLI
Use the ``meshagent secret`` commands to automate creation and rotation:

```bash bash
meshagent secret keys create \
  --name weather-api \
  --data "WEATHER_API_KEY=... WEATHER_API_ENDPOINT=https://api.example.com"

meshagent secret list           # review existing secrets
meshagent secret delete <id>    # remove an unused secret
```

Attach the secret when creating or updating your service:

```bash bash
meshagent service create \
  --name weather-agent \
  --image gcr.io/example/weather:latest \
  --env-secret weather-api
```

## Supplying Sensitive Values to Room Containers
Room containers launched through the ``room.containers`` API do not consume shared secret key collections. Provide sensitive data at launch time instead:

- Define template variables with ``obscure: true`` inside your ``kind: ServiceTemplate`` manifest so MeshAgent hides the value in the Studio UI.
- Pass ``--var KEY=value`` or ``--env KEY=value`` to ``meshagent container run`` for one-off launches.
- If multiple rooms need the same credential, consider promoting the workload to a project service so you can use a secret key collection.

```yaml yaml
variables:
  - name: weather_api_key
    description: "API key for the weather provider"
    obscure: true
```

## Image Pull Secrets
### What they are
Image pull secrets store registry credentials (Docker Hub, Artifact Registry, Azure Container Registry, and others). MeshAgent uses them to authenticate when pulling the container image; the credentials never appear inside the running container.

### Configure in MeshAgent Studio
1. Open **Services & Room Containers → Image Pull Secrets**.
2. Select the registry type and provide the required fields (server, username, password/service account, etc.).
3. Save the secret.

### Reference in a Service manifest
Specify the secret name in ``pull_secret`` so MeshAgent can fetch the image.

```yaml yaml
pull_secret: acme-registry
```

### CLI options
Create registry secrets programmatically:

```bash bash
meshagent secret docker create \
  --name acme-registry \
  --server registry.example.com \
  --username bot \
  --password ******
```

Room containers support launch-time credentials via ``--cred``:

```bash bash
meshagent container run \
  --image registry.example.com/tools:latest \
  --cred registry.example.com,bot,******
```

## Best Practices
- Attach each secret only to the services that require it.
- Rotate credentials regularly: create or update the secret, redeploy, then delete the old one.
- Prefer secret key collections for centrally managed credentials; use template variables for room container inputs that users supply.
- Audit unused secrets from Studio or with ``meshagent secret list`` to keep your project tidy.

## Related Topics
- [Configure project services](./project-services/configuration)
- [Configure room containers](./room-containers/configuration)
- [Run room containers](./room-containers/running)
- [Operations & Troubleshooting](./operations)
