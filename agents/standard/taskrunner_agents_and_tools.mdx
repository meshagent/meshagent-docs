---
title: "Wrap an Existing Agent"
---

import PydanticAgents from "/snippets/examples/python/agents/taskrunner/pydantic_agents.mdx"
import InvokingTaskRunner from "/snippets/examples/python/agents/taskrunner/invoking_taskrunner.mdx"

This example shows how to wrap an existing Pydantic AI translation agent with a MeshAgent [``TaskRunner``](./taskrunner). We extend the base ``TaskRunner`` class to create our ``TranslationTaskRunner`` with a defined input schema, output schema, and ask method. 

### Example: Integrating a Pydantic AI Agent
Copy this code into a file called ``translator.py``. You will need to create and export an ``ANTHROPIC_API_KEY`` first for this to run. Or update the example to use a model from a different provider of your choice. 

<CodeGroup>
    <PydanticAgents />
</CodeGroup>

### Running the TaskRunner

From the terminal start your service locally. Be sure you are in an activated virtual environment where meshagent and pydantic_ai are installed: 

```bash bash
meshagent setup # this will authenticate you 
meshagent service run "translator.py" --room=translate
```

**In the Studio**
1. Go to [MeshAgent Studio](https://studio.meshagent.com) 
2. Enter the room ``translate``
3. Click the upper left menu --> "Run Task"
4. Select **translator** from the agent dropdown 
5. Enter the text to translate
6. Results appear and are saved to room storage under the "translations" folder 

**Invoking the TaskRunner Programmatically**

Instead of invoking the agent through the Studio, you can also run the agent through the CLI or write code to do so.

While the service is running, from a separate tab in your terminal run: 
```bash CLI
meshagent agents ask \
  --room=translate \
  --agent=translator \
  --input='{"text":"I love MeshAgent!"}'
```

This will return a result like: 
```
Connecting to room...
Asking agent...
{"french_translation": "J'adore MeshAgent !", "spanish_translation": "\u00a1Me encanta MeshAgent!"}
```

Alternatively, we can create and run a file called ``invoke_translator.py``:
<CodeGroup>
    <InvokingTaskRunner />
</CodeGroup>

Next from your terminal run: 
```bash bash
# Create, Activate, and export your MESHAGENT_API_KEY if you haven't already
# meshagent api-key create my-api-key activate
# export MESHAGENT_API_KEY="xxxxxxx"
python invoke_translator.py
```

You will see the result logged to your terminal and saved in the room. 

## Example: Using TaskRunner Agents as Agent Tools
TaskRunners can also be surfaced in toolkits and used as tools by other agents using ``RunTaskTool``. Exposing agents as tools and then giving those tools to a ChatBot is a great way to get started building multi-agent systems. 

Let's try this out by creating a new ChatBot and giving it a tool, the Pydantic AI translation agent that we defined above. 

### Creating the service with agents-as-tools
At the end of our ``translator.py`` file all we have to add is the new ChatBot service and pass it the ``translator`` agent as a ``RequiredToolkit``.

```python Python
@service.path("/chatwithtools")
class ChatBotAgentTools(ChatBot):
    def __init__(self):
        super().__init__(
            name="mychatbot",
            llm_adapter=OpenAIResponsesAdapter(),
            requires=[RequiredToolkit(name="agents", tools=["translator"])],
        )
```

### Running an agent with agents-as-tools

The ``ServiceHost`` will automatically discover and start both the translation agent and the chatbot. 
```bash bash
meshagent service run "translator.py" --room=translate
```

### Using an agent with agents as tools

**In the Studio**:
1. Go to [studio.meshagent.com](https://studio.meshagent.com)
2. Enter the room translate
3. In the participants list, you'll see the ``chatagent``
4. Click on ``chatagent`` to start chatting with the agent
5. Ask it something like: "Can you translate 'Hello, how are you?' for me?"
6. The ``chatagent`` will automatically use the ``translator`` agent as a tool to complete the request and you will see the JSON results added to the translations folder in the room storage. 

> **Remember**: You can still use the translator agent directly since it is running in the room, this approach just demonstrates an easy way to use a TaskRunner agent as a tool for another agent.