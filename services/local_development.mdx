---
title: Running Services Locally
---

import SimpleChatbot from "/snippets/examples/python/agents/chatbot/simple_chatbot.mdx"

Build and test services on your machine, then deploy to production using MeshAgent's ``ServiceHost``.

## ServiceHost Basics
MeshAgent's ``ServiceHost`` exposes your agents or tools as HTTP webhook endpoints. When you create a ``ServiceHost``, it starts an HTTP server that listens for incoming webhook requests from MeshAgent. When a webhook call arrives, the ``ServiceHost`` automatically spins up your agent or tool, connects it to the requested room, and manages its lifecycle until the session ends. 

Let's define a simple chatbot service: 
<CodeGroup>
    <SimpleChatbot/>
</CodeGroup>

**Note**: The default port is 8081. You can set a specific port by passing the ``MESHAGENT_PORT`` environment variable or passing a port to the ``ServiceHost`` constructor. For example, ``host = ServiceHost(port=9000)`` or ``host = ServiceHost(port=int(os.getenv("MESHAGENT_PORT", "9001")))``.  

## Running the Service Locally
Save your code as ``main.py`` then from the terminal run: 

```bash bash
meshagent setup # authenticate to meshagent if not already done
meshagent service run "main.py" --room=myroom
```

You'll see an output showing the connection process: 
```
Connecting to room...
Connecting port 8081...
Connecting endpoint /chat as chatbot...
INFO:services:starting -> 0.0.0.0:8081/chat -> SimpleChatbot
INFO:webhooks:received request http://localhost:8081/chat POST, upgrade: None
INFO:services:chatbot answering call and joining room
```

This command handles everything for you: 
- Starts your ``ServiceHost`` HTTP server locally
- Automatically detects all endpoints 
- Calls each endpoint into the specified room 
- Use the ``identity`` from your ``@service.path()`` decorator as the participant name

Now go to [studio.meshagent.com](https://studio.meshagent.com) and select the room ``myroom``. You'll see the ``chatbot`` available in the participants tab and can select it to begin chatting.

## Development Workflow
1. Write your service using ``ServiceHost`` and set the path and identity for each agent or tool
2. Run and test using ``meshagent service run "main.py" --room=myroom``
4. Experiment with the agent in the [MeshAgent Studio](https://studio.meshagent.com) 
4. Iterate quickly - Stop the service (Ctrl+C), make applicable updates to your ``main.py`` file, then restart the service using the ``meshagent service run`` command. 

## Working with multiple agents or tools in a single service

You can register multiple agents or tools in a single ``ServiceHost`` using different paths. This makes it easy to bundle related agents and tools together into a single deployable service. 

```python Python
service = ServiceHost()

@service.path(path="/chat", identity="chatbot")
class ChatAgent(ChatBot):
    # ... chat agent implementation

@service.path(path="/dataanalysis", identity="data-analsis-tool") 
class DataAnalysis(Tool):
    # ... data analysis tool implementation

@service.path(path="/helper", identity="task-helper")
class HelperAgent(TaskRunner):
    # ... helper agent implementation
```

Using ``meshagent service run "main.py" --room=myroom`` will automatically detect and call all three endpoints into the room with their respective identities.

## Next Steps: 
Once your service works locally you're ready to:

**Deploy as a Project Level Service**: 
- [Configure for Project Level Deployment](./service_configuration): Set up applicable environment variables, health checks, and ports
- [Deploy your Project Level Service](./service_deployment): Make it available to all rooms in your project

**Use as a Room Level Service**:
- [Configure for Room Level Deployment](../containers/containers_configuration): Package room-specific containers that others can run and inject applicable variables at runtime. 
- [Run in a single Room](../containers/containers_configuration): Use your service in a specific room in your project.
